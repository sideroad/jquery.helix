(function(f){var e=function(g,h){g.removeClass("show first last focus");g.filter(":lt("+h.devide+")").addClass("show");g.filter(":first").addClass("first");g.filter(":eq("+(h.half)+")").addClass("focus");g.filter(":eq("+(h.devide-1)+")").addClass("last")},a=function(j){var l=j.addClass("helix").children(),u=f.extend({width:j.width(),height:j.height(),item:{width:l.width()},devide:8,rampRate:2,margin:"50%"},arguments[1],true),t=(function(w){var v=u.item.width;if(/%$/.test(w)){w=v*w.substr(0,w.length-1)/100}return v+w})(u.margin),k=l.length,q=u.devide>k?k:u.devide,i=0,h=360/q,g=Math.round((t/2)/Math.tan(Math.PI/q)),m=0,s=parseInt(q/2),r=f("<div class='helix-container' ></div>").css({"-webkit-perspective":u.width,perspective:u.width,width:u.item.width,height:u.height}),p=((s+(q%2))*h),o=u.rampRate*u.height/k,n={distance:h,length:k,size:t,children:l,translateZ:g,rotateY:p,focus:s,first:0,last:l.length-1,half:s,ramp:o,devide:q};l.filter(":gt("+(k-(q/2)-1+(k%2))+")").prependTo(j);l=j.children();l.each(function(){var v=f(this);v.css("transform","rotateY( "+parseInt(i)+"deg ) translateZ( "+g+"px )").transition({y:m*o});i+=h;m++});e(l,n);j.wrap(r);j.css({transform:"translateY(-"+(s*o)+"px) translateZ( -"+g+"px ) rotateY("+p+"deg)",width:u.item.width}).show().data(n);return j},b=function(i,q){var l=i.data(),k=l.children,g=l.distance,h=l.translateZ,o=l.rotateY,j=l.length,t=l.focus,m=l.first,r=l.last,s=l.half,n=l.ramp,g=l.distance,p=l.devide;o+=g*q*-1;t+=q;r+=q;m+=q;k=i.children();if(q===1){k.filter(":first").transition({y:r*n,rotateY:r*g,duration:0}).appendTo(i)}else{k.filter(":last").transition({y:m*n,rotateY:m*g,duration:0}).prependTo(i)}e(i.children(),l);i.css("transform","translateY("+(t*n*-1)+"px) translateZ( -"+h+"px ) rotateY("+parseInt(o)+"deg)").data({rotateY:o,children:k,focus:t,first:m,last:r})},c=function(g){b(g,1)},d=function(g){b(g,-1)};f.fn.helix=function(g){return(g==="next")?c(this):(g==="prev")?d(this):a(this)}})(jQuery);